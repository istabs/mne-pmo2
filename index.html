<!DOCTYPE HTML>
<html>

<head>
	<title>
		Firebase access.
	</title>

	<script src="https://www.gstatic.com/firebasejs/ui/4.6.1/firebase-ui-auth.js"></script>
	<link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.6.1/firebase-ui-auth.css" />

</head>

<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-analytics.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-firestore.js"></script>

<script>
	const firebaseConfig = {
		apiKey: "AIzaSyBLno126jESgr7JzuOADmImv1D0EkBkfNI",
		authDomain: "mne-pmo.firebaseapp.com",
		databaseURL: "https://mne-pmo-default-rtdb.europe-west1.firebasedatabase.app/",
		projectId: "mne-pmo",
		storageBucket: "mne-pmo.appspot.com",
		messagingSenderId: "1027876211335",
		appId: "1:1027876211335:web:98ee15cb97dc0298134622",
		measurementId: "G-7X7SYD20HZ"
	};
</script>

<script>
	firebase.initializeApp(firebaseConfig);
	var ui = new firebaseui.auth.AuthUI(firebase.auth());
	var uiConfig = {
		signInSuccessUrl: 'retrieve.html',
		signInOptions: [
			firebase.auth.GoogleAuthProvider.PROVIDER_ID,
			//firebase.auth.FacebookAuthProvider.PROVIDER_ID,
			//firebase.auth.TwitterAuthProvider.PROVIDER_ID,
			//firebase.auth.GithubAuthProvider.PROVIDER_ID
		],
		// tosUrl and privacyPolicyUrl accept either url string or a callback
		// function.
		// Terms of service url/callback.
		//tosUrl: '<your-tos-url>',
		// Privacy policy url/callback.
		//privacyPolicyUrl: function () {
			//window.location.assign('<your-privacy-policy-url>');
		//},
	};
	ui.start('#firebaseui-auth-container', uiConfig)
</script>

<script>
	initApp = function () {
		firebase.auth().onAuthStateChanged(function (user) {
			if (user) {
				// User is signed in.
				var displayName = user.displayName;
				var email = user.email;
				var emailVerified = user.emailVerified;
				var photoURL = user.photoURL;
				var uid = user.uid;
				var phoneNumber = user.phoneNumber;
				var providerData = user.providerData;
				user.getIdToken().then(function (accessToken) {
					document.getElementById('sign-in-status').textContent = 'ativa';
					//document.getElementById('sign-in').textContent = 'Sign out';
					document.getElementById('account-details').textContent = JSON.stringify({
						//displayName: displayName,
						email: email,
						emailVerified: emailVerified,
						//phoneNumber: phoneNumber,
						//photoURL: photoURL,
						//uid: uid,
						//accessToken: accessToken,
						//providerData: providerData
					}, null, '  ');
				});
			} else {
				// User is signed out.
				document.getElementById('sign-in-status').textContent = 'inativa';
				//document.getElementById('sign-in').textContent = 'Sign in';
				document.getElementById('account-details').textContent = 'null';
			}
		}, function (error) {
			console.log(error);
		});
	};

	window.addEventListener('load', () => initApp());
</script>

<body>
	<h1>MNE-PMO</h1>
	<div id="firebaseui-auth-container"></div>
	<p><div id="loader">A carregar...</div></p>
	<p>O sessão está <span id="sign-in-status">.</span></p>
	<div id="sign-in"></div>
	<p>Os detalhes da sessão são:</p>
	<pre id="account-details"></pre>
	<button href="retrieve.html">Continuar</button>
</body>

</html>